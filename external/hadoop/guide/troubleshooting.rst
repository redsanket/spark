..  _troubleshooting:

Troubleshooting
===============

.. _logging_monitoring_and_alerting:

Logging, Monitoring and Alerting
--------------------------------


- **Logs Categories:**

  - Server Logs: record all requests that were made of the server: IP, URL, response, ..etc. they provide access and error logs
  - Application Server Logs: logs generated by applications. This helps understanding how the application is used. Logs generated by hadoop daemons can be considered Application level.

- **Types of Logs:**

  - ``.log``: Logs of running daemons will be available here in this .log file.
  - ``.out``: will have startup messages of a daemon. These messages will be useful to troubleshoot startup failures of a daemon.
  - ``.log.{timestamp}.(bz2|gz)``: Old log files will have date in their name. by default log rotation is daily.
  - ``gc-{component}.log-{yyyyMMddHHmm}``: GC logs for each component  (namenode, datanode, ..etc)

Hadoop offers CLI to browse the logs

- **applications logs:** ``yarn logs -applicationId <application ID> [OPTIONS]``
  - am <AM Containers> Prints the AM Container logs for this application.
  - containerId <Container ID> it will only print syslog if the application is running. Work with -logFiles to get other logs.
  - logFiles <Log File Name> Work with -am/-containerId and specify comma-separated value to get specified container log files. Use "ALL" to fetch all the log files for the container.
- **job logs:** ``mapred job [-logs <job-id> <task-attempt-id>]``

.. _logging_monitoring_and_alerting_logs_location:

Logs location and content
~~~~~~~~~~~~~~~~~~~~~~~~~

**1.Namenode (/home/gs/var/log/hdfs):**

.. table:: Namenode Logs

  +-----------------------------------------------------+----------------------------------------+
  | Log                                                 | Description                            | 
  +=====================================================+========================================+
  | hadoop-hdfs-namenode-{hostname}                     |                                        |
  |                       .log(.{yyyy-MM-dd-HH}.bz2)?   | Runtime logs from the namenode process |
  +-----------------------------------------------------+----------------------------------------+
  | gc-namenode.log-{yyyyMMddHHmm}                      | Logs of the GC from namenode           |
  +-----------------------------------------------------+----------------------------------------+
  | gc-balancer.log-{yyyyMMddHHmm}                      | Logs of the GC from balancer           |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-hdfs-balancer-{hostname}                     |                                        |
  |                       .log(.{yyyy-MM-dd-HH}.bz2)?   | Runtime logs from the balancer process |  
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-hdfs-balancer-{hostname}.out                 | Messages during startup from balancer  |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-namenode-jetty.log.{yyyy_MM_dd}(.gz)?        | Runtime logs from Jetty for namenode   |
  +-----------------------------------------------------+----------------------------------------+
  | hdfs-audit.log(.{yyyy-MM-dd-HH}.bz2)?               | Accounting all operations              |
  +-----------------------------------------------------+----------------------------------------+
  | hdfs-auth.log(.{yyyy-MM-dd-HH}.bz2)?                | Accounting authentications             |
  +-----------------------------------------------------+----------------------------------------+

**2.Datanode (/home/gs/var/log/hdfs):**

.. table:: Datanode Logs

  +-----------------------------------------------------+----------------------------------------+
  | Log                                                 | Description                            | 
  +=====================================================+========================================+
  | hadoop-hdfs-datanode-{hostname}                     |                                        |
  |                       .log(.{yyyy-MM-dd-HH}.bz2)?   | Runtime logs from the datanode process |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-datanode-webhdfs.log(.{yyyy-MM-dd}.bz2)?     | Records URL, size, user..etc           |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-hdfs-datanode-{hostname}.out                 | Messages during startup                |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-datanode-jetty.log.{yyyy_MM_dd}(.gz)?        | Access Requests URLs                   |  
  +-----------------------------------------------------+----------------------------------------+
  | gc-datanode.log-{yyyyMMddHHmm}                      | Logs of the GC from datanode process   |
  +-----------------------------------------------------+----------------------------------------+
  | jsvc.out                                            |                                        |
  +-----------------------------------------------------+----------------------------------------+
  | jsvc.err                                            |                                        |
  +-----------------------------------------------------+----------------------------------------+
  
**3.Mapreduce (/home/gs/var/log/mapred):**

.. table:: Yarn/Mapreduce Logs

  +-----------------------------------------------------+----------------------------------------+
  | Log                                                 | Description                            | 
  +=====================================================+========================================+
  | yarn-mapred-historyserver-{hostname}                |                                        |
  |                     .log(.{yyyy-MM-dd-HH}.bz2)?     | Runtime logs from historyserver process|
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-resourcemanager-{hostname}              |                                        |
  |                     .log(.{yyyy-MM-dd-HH}.bz2)?     | Runtime logs from the resource Manager |
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-timelineserver-{hostname}               |                                        |
  |                     .log(.{yyyy-MM-dd-HH}.bz2)?     | Runtime logs from the timelineserver   |
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-nodemanager-{hostname}                  |                                        |
  |                     .log(.{yyyy-MM-dd-HH}.bz2)?     | Runtime logs from the nodemanager      |  
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-historyserver-{hostname}.out            | Startup of historyserver               |
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-resourcemanager-{hostname}.out          | Startup of resourcemanager             |
  +-----------------------------------------------------+----------------------------------------+
  | yarn-mapred-timelineserver-{hostname}.out           | Startup of teimlineserver              |
  +-----------------------------------------------------+----------------------------------------+
  | mapred-jobsummary.log(.{yyyy-MM-dd}.bz2)?           | Logs the summary of each completed job |
  +-----------------------------------------------------+----------------------------------------+
  | rm-appsummary.log(.{yyyy-MM-dd}.bz2)?               | the summary of each app                |
  +-----------------------------------------------------+----------------------------------------+
  | rm-audit.log(.{yyyy-MM-dd}.bz2)?                    | List of all operations                 |
  +-----------------------------------------------------+----------------------------------------+
  | rm-auth.log(.{yyyy-MM-dd}.bz2)?                     |  logs the authentications for the RM   |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-jobhistory-jetty.log.{yyyy_MM_dd}(.gz)?      | Runtime logs from historyserver Jetty  |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-resourcemanager-jetty.log.{yyyy_MM_dd}(.gz)? | Runtime logs from the jetty RM         |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-timelineserver-jetty.log.{yyyy_MM_dd}(.gz)?  | Runtime logs from the timeline Jetty   |
  +-----------------------------------------------------+----------------------------------------+
  | hadoop-nodemanager-jetty.log.{yyyy_MM_dd}(.gz)?     | Runtime logs from the nodemanager Jetty|
  +-----------------------------------------------------+----------------------------------------+
  | timelineserver-auth.log(.yyy-MM-dd-HH.bz2)?         | Authentications for timelineserver     |
  +-----------------------------------------------------+----------------------------------------+
  | gc-jobhistory.log-{yyyyMMddHHmm}                    | Logs of the GC from jobhistory process |
  +-----------------------------------------------------+----------------------------------------+
  | gc-nodemanager.log-{yyyyMMddHHmm}                   | Logs of the GC from NM process         |
  +-----------------------------------------------------+----------------------------------------+
  | gc-resourcemanager.log-{yyyyMMddHHmm}               | Logs of the GC from RM process         |
  +-----------------------------------------------------+----------------------------------------+
  | gc-timelineserver.log-{yyyyMMddHHmm}                |  GC logs from timelineserver  process  |
  +-----------------------------------------------------+----------------------------------------+
  
  
  
  
  
  
  
  
  
  
  
