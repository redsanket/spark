<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>

	<groupId>hadooptest</groupId>
	<artifactId>hadooptest-parent</artifactId>
	<version>1.0-SNAPSHOT</version>
	<packaging>pom</packaging>

	<name>hadooptest</name>
	<url>http://maven.apache.org</url>

	<!-- This allows us to depend directly on SNAPSHOT -->
	<repositories>
		<repository>
			<id>apache-snapshots</id>
			<url>http://repository.apache.org/content/groups/snapshots-group/</url>
			<releases>
				<enabled>true</enabled>
			</releases>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</repository>
		
		<repository>
            <id>yahoo-snapshots</id>
            <url>http://ymaven.corp.yahoo.com:9999/proximity/repository/public/</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
	</repositories>

	<!-- Define Hadoop version used to compile HTF code for 2.x -->
	<properties>
		<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
		<hadoop.version.ut.old>2.0.4.0.1304041432</hadoop.version.ut.old>
		<hadoop.version.current>2.2.0-SNAPSHOT</hadoop.version.current>
		<hadoop.version>${hadoop.version.current}</hadoop.version>
	</properties>

	<profiles>
		<!-- PROFILE FOR ECLIPSE: For build environment -->
		<!-- PROFILE FOR CI: For CI build environment on corp RE hosts,
                     and CI test execution or build on colo gateway clients. -->

		<!-- PROFILE FOR ECLIPSE -->
		<profile>
			<id>profile-eclipse</id>

			<activation>
				<file>
                                       <!-- /home/y/ directory does not exists on individual 
                                            windows/mac/linux box. -->
					<missing>/home/y/lib/jars/yjava_byauth.jar</missing>
				</file>
			</activation>

			<properties>
				<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
			</properties>

			<dependencies>
				<dependency>
					<groupId>coretest</groupId>
					<artifactId>coretest</artifactId>
					<version>1.0-SNAPSHOT</version>
					<scope>provided</scope>
				</dependency>
				<dependency>
					<groupId>coretest</groupId>
					<artifactId>coretest</artifactId>
					<classifier>sources</classifier>
					<version>1.0-SNAPSHOT</version>
					<scope>provided</scope>
				</dependency>
				<!-- GDM automation dependency for yjava auth -->
				<dependency>
					<groupId>yahoo.yinst.yjava_byauth</groupId>
					<artifactId>yjava_byauth</artifactId>
					<version>0.6.0</version>
				</dependency>
			</dependencies>
		</profile>

		<!-- PROFILE FOR CI -->
		<profile>
			<id>profile-ci</id>
			<!-- This profile is used for 1) building the maven
                             package target primarily on the RE hosts (corp
                             side), and occasionally on the gateway client
                             (colo side). A prerequisite is to run the script
                             "scripts/ci_install_jar" to pull in the dependent
                             jar files not defined by the maven dependencies in
                             the pom definition. This is because the coretest jar
                             is not in the maven repository, and the yjava_byauth
                             jar is only accessible via the ymaven repository
                             from corp, but not from the colo. -->
			<activation>
				<file>
				    <!-- /homes/hadoopqa directory exists only on the RE and 
				         gateway hosts -->
					<exists>/homes/hadoopqa</exists>
				</file>
			</activation>

			<!-- Run script to set up jar files inaccessible from
                             the ymaven repo (e.g. coretest), or via the ymaven
                             repo on the colo (e.g. yjava_byauth) -->
			<build>
				<plugins>
					<plugin>
						<groupId>org.codehaus.mojo</groupId>
						<artifactId>exec-maven-plugin</artifactId>
						<version>1.2.1</version>
						<executions>
							<execution>
								<id>exec</id>
								<goals>
									<goal>exec</goal>
								</goals>
								<phase>compile</phase>
							</execution>
						</executions>
						<configuration>
							<executable>scripts/ci_install_jar</executable>
						</configuration>
					</plugin>
				</plugins>
			</build>

			<properties>
				<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
				<coretest.jar.dir>/home/y/etc/coretest/java/lib/</coretest.jar.dir>
				<yinst.lib.dir>/home/y/lib/jars/</yinst.lib.dir>
			</properties>

			<dependencies>
				<dependency>
					<groupId>system</groupId>
					<artifactId>system-coretest</artifactId>
					<version>0.9.2</version>
					<scope>system</scope>
					<systemPath>${coretest.jar.dir}/coretest-1.0-SNAPSHOT.jar</systemPath>
				</dependency>
				<!-- GDM automation dependency for yjava auth -->
				<dependency>
					<groupId>system</groupId>
					<artifactId>yjava_byauth</artifactId>
					<version>0.9.2</version>
					<scope>system</scope>
					<systemPath>${yinst.lib.dir}/yjava_byauth.jar</systemPath>
				</dependency>
			</dependencies>
		</profile>

	</profiles>

	<build>
		<resources>
			<resource>
				<directory>src/main/resources</directory>
			</resource>
			<resource>
				<directory>resources</directory>
			</resource>
		</resources>

		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-jar-plugin</artifactId>
				<version>2.2</version>
				<executions>
					<execution>
						<goals>
							<goal>test-jar</goal>
						</goals>
					</execution>
				</executions>
			</plugin>

			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-javadoc-plugin</artifactId>
				<version>2.9</version>
				<configuration>
					<outputDirectory>../..</outputDirectory>
					<reportOutputDirectory>../..</reportOutputDirectory>
					<destDir>hadooptest-javadoc</destDir>
					<aggregate>true</aggregate>
					<quiet>true</quiet>
					<excludePackageNames>hadooptest.cluster.mini:hadooptest.cluster.mini.*:hadooptest.cluster.standalone</excludePackageNames>
				</configuration>
			</plugin>

		</plugins>

	</build>

	<dependencies>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>4.8.2</version>
		</dependency>
		<dependency>
			<groupId>log4j</groupId>
			<artifactId>log4j</artifactId>
			<version>1.2.12</version>
		</dependency>

		<!-- GDM automation dependency for JSON -->
		<dependency>
			<groupId>net.sf.json-lib</groupId>
			<artifactId>json-lib</artifactId>
			<version>2.4</version>
			<classifier>jdk15</classifier>
		</dependency>

		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-common</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-common</artifactId>
			<version>${hadoop.version}</version>
			<type>test-jar</type>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-hdfs</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-hdfs</artifactId>
			<version>${hadoop.version}</version>
			<type>test-jar</type>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-app</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-common</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-core</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-hs</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-jobclient</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-client-jobclient</artifactId>
			<version>${hadoop.version}</version>
			<type>test-jar</type>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-yarn-common</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-yarn-server-tests</artifactId>
			<version>${hadoop.version}</version>
			<type>test-jar</type>
			<scope>provided</scope>
		</dependency>

		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-yarn-client</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-yarn-server-nodemanager</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-yarn-server-resourcemanager</artifactId>
			<version>${hadoop.version}</version>
			<scope>provided</scope>
		</dependency>

		<!-- This is temporarily disabled due to Bugzilla Ticket 6204559 - Hadoop 
			internal dist package hadoop_mvn_yarn is missing the hadoop-yarn-client.jar 
			dependency> <groupId>org.apache.hadoop</groupId> <artifactId>hadoop-mapreduce-examples</artifactId> 
			<version>${hadoop.version}</version> <type>test-jar</type> <scope>provided</scope> 
			</dependency -->

		<dependency>
			<groupId>org.apache.hadoop</groupId>
			<artifactId>hadoop-mapreduce-examples</artifactId>
			<version>0.23.7</version>
			<scope>provided</scope>
		</dependency>

	</dependencies>

</project>
